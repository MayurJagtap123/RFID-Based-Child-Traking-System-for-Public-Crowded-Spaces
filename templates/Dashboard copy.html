<!DOCTYPE html>
<html lang="en">
  <head>
    <meta name="description" content="Vali is a responsive and free admin theme built with Bootstrap 5, SASS and PUG.js. It's fully customizable and modular.">
    <!-- Twitter meta-->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:site" content="@pratikborsadiya">
    <meta property="twitter:creator" content="@pratikborsadiya">
    <!-- Open Graph Meta-->
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="Vali Admin">
    <meta property="og:title" content="Vali - Free Bootstrap 5 admin theme">
    <meta property="og:url" content="http://pratikborsadiya.in/blog/vali-admin">
    <meta property="og:image" content="http://pratikborsadiya.in/blog/vali-admin/hero-social.png">
    <meta property="og:description" content="Vali is a responsive and free admin theme built with Bootstrap 5, SASS and PUG.js. It's fully customizable and modular.">
    <title>Admin - Dashboard</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Main CSS-->
    <link rel="stylesheet" type="text/css" href="../static/Dashboard.css">

    <!-- Font Awesome CDN -->
   <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

    <!-- Font-icon css-->
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-app.js";
      import { getFirestore, collection, getDocs, query, orderBy } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-firestore.js";
    
      // Firebase Configuration
      const firebaseConfig = {
        apiKey: "AIzaSyAswX1kuf9rdA3UaSM_PNl5FVAnsbUdWd4",
        authDomain: "rfidchildtracking.firebaseapp.com",
        projectId: "rfidchildtracking",
        storageBucket: "rfidchildtracking.firebasestorage.app",
        messagingSenderId: "331408176416",
        appId: "1:331408176416:web:284d52d8f1762bbc249345",
        measurementId: "G-YBW0CJNXWZ"
      };
    
      // Initialize Firebase
      const app = initializeApp(firebaseConfig);
      const db = getFirestore(app);
    
      // Function to fetch data and update counts
      async function fetchDataAndUpdateCounts() {
        try {
          const q = query(collection(db, "rfid_images"), orderBy("timestamp", "desc"));
          const querySnapshot = await getDocs(q);
    
          const uniqueUsers = new Set();
          const uniqueRfids = new Set();
    
          querySnapshot.forEach((doc) => {
            const data = doc.data();
            const name = data.Name || "Unknown";
            const rfid = data.rfid_id || "N/A";
    
            uniqueUsers.add(name);
            uniqueRfids.add(rfid);
          });
    
          // Update the counts on the dashboard
          document.getElementById("userCount").innerText = uniqueUsers.size;
          document.getElementById("rfidCount").innerText = uniqueRfids.size;
        } catch (error) {
          console.error("Error fetching data: ", error);
        }
      }
    
      // Load Data on Page Load
      document.addEventListener("DOMContentLoaded", fetchDataAndUpdateCounts);
    </script>
  </head>
  <body class="app sidebar-mini">
    <!-- Navbar-->
    <header class="app-header"><a class="app-header__logo" href="index.html">Admin Dashboard</a>
      <!-- Sidebar toggle button--><a class="app-sidebar__toggle" href="#" data-toggle="sidebar" aria-label="Hide Sidebar"></a>
      <!-- Navbar Right Menu-->
      <ul class="app-nav">
        <li class="app-search">
          <input class="app-search__input" type="search" placeholder="Search">
          <button class="app-search__button"><i class="bi bi-search"></i></button>
        </li>
        <!--Notification Menu-->
        <li class="dropdown"><a class="app-nav__item" href="#" data-bs-toggle="dropdown" aria-label="Show notifications"><i class="bi bi-bell fs-5"></i></a>
          <ul class="app-notification dropdown-menu dropdown-menu-right">
           
          </ul>
        </li>
        <!-- User Menu-->
        <li class="dropdown"><a class="app-nav__item" href="#" data-bs-toggle="dropdown" aria-label="Open Profile Menu"><i class="bi bi-person fs-4"></i></a>
          <ul class="dropdown-menu settings-menu dropdown-menu-right">
            <li><a class="dropdown-item"><i class="bi bi-person me-2 fs-5"></i> Profile</a></li>
            <li><a class="dropdown-item"><i class="bi bi-box-arrow-right me-2 fs-5"></i>Logout</a></li>
          </ul>
        </li>
      </ul>
    </header>
        <!-- User Menu-->
       
   
    <!-- Sidebar menu-->
    <div class="app-sidebar__overlay" data-toggle="sidebar"></div>
    <aside class="app-sidebar">
    <div class="app-sidebar__user"><img class="app-sidebar__user-avatar" src="https://randomuser.me/api/portraits/men/1.jpg" alt="User Image"></div>
      <ul class="app-menu">
        <li><a class="app-menu__item active" href="dashboard.html"><i class="app-menu__icon bi bi-speedometer"></i><span class="app-menu__label">Dashboard</span></a></li>
        <!-- <li class="treeview"><a class="app-menu__item" href="UserForm.html" data-toggle="treeview"><span class="app-menu__label"><i class="fas fa-user-plus" style="font-size: 24px; color: white; margin-right: 10px;"></i> -->
          Add User</span></a>
        <li class="treeview"><a class="app-menu__item" href="Trcak user.html" data-toggle="treeview"></i><span class="app-menu__label "><i class="fas fa-location-arrow" style="font-size: 24px; color: white; margin-right: 10px;"></i>Track User</span></a></li>
      </ul>
    </aside>
    
    <!-- main contents -->
    <main class="app-content">
      <div class="app-title">
        <div>
          <h1><i class="bi bi-speedometer"></i> Dashboard</h1>
        </div>
        <ul class="app-breadcrumb breadcrumb">
          <li class="breadcrumb-item"><i class="bi bi-house-door fs-6"></i></li>
          <li class="breadcrumb-item"><a href="#">Dashboard</a></li>
        </ul>
      </div>
      <div class="row d-flex align-items-center justify-content-between">
  
        <!-- Users Card -->
        <div class="col-md-6 col-lg-3">
          <div class="widget-small primary coloured-icon">
            <i class="icon bi bi-people fs-1"></i>
            <div class="info">
              <h4>Users</h4>
              <p><b id="userCount">0</b></p>
            </div>
          </div>
        </div>
      
        <!-- RFID NOS Card -->
        <div class="col-md-6 col-lg-3">
          <div class="widget-small info coloured-icon">
            <i class="icon bi bi-heart fs-1"></i>
            <div class="info">
              <h4>Rfid Nos</h4>
              <p><b id="rfidCount">0</b></p>
            </div>
          </div>
        </div>
      
        <!-- Check Faces Button (Aligned Right) -->
        <div class="col-md-6 col-lg-3 d-flex justify-content-end">
          <button class="btn fw-bold shadow-lg mb-3" 
                  style="width: 300px; height: 70px; font-size: 20px; background-color: whitesmoke; border-color: whitesmoke
                  ; color:black;">
            Check Fases 
          </button>
        </div>
      </div>
        <div class="col-md-12">
            <div class="tile">
              <h3 class="tile-title">No of Users</h3>
              <div class="ratio ratio-16x9">
                <div id="salesChart"></div>
              </div>
            </div>
          </div>
      </div>
    </main>
  </body>
</html>